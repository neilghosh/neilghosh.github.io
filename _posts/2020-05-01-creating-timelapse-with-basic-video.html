---
layout: post
title: Creating timelapse with basic video processing using ffmpeg
date: '2020-05-01T14:26:00.001+05:30'
author: Neil Ghosh
tags: 
modified_time: '2020-05-01T14:26:21.145+05:30'
thumbnail: https://i.ytimg.com/vi/e_rJqVCBTiA/0.jpg
blogger_id: tag:blogger.com,1999:blog-6081677503074893817.post-8258251630179113105
blogger_orig_url: https://www.neilghosh.com/2020/05/creating-timelapse-with-basic-video.html
---

<div dir="ltr" style="text-align: left;" trbidi="on">Key idea of time-lapse is to take a series of photos in regular intervals with a fixed settings and field of view. I have a Cannon 600D (T3i) which is apparently most popular DSLR ever (probably because neither too basic nor too expensive). This doesn't really have any built in feature where I could take series of photos automatically at a fixed interval. I had recently installed magic lantern firmware which has some cool additional features like <a href="https://wiki.magiclantern.fm/userguide#intervalometer" target="_blank">intervalometer&nbsp; </a><br /><br /><br /><div class="separator" style="clear: both; text-align: center;"><br /></div><div style="text-align: center;"><iframe allowfullscreen="" class="YOUTUBE-iframe-video" data-thumbnail-src="https://i.ytimg.com/vi/e_rJqVCBTiA/0.jpg" frameborder="0" height="266" src="https://www.youtube.com/embed/e_rJqVCBTiA?feature=player_embedded" width="320"></iframe></div><br /><br />The Yi Action camera that I have also has feature built in to take time-lapse. In "Video Timelapse" mode it automatically stitches the photos taken in the specified interval and we get the video as output. However in this mode we don't really have much control the setting of the photos like exposure and shutter speed. These settings are critical for night sky or low light areas. So the other mode called "photo time-lapse" is the right choice here. In this mode you get the JPEG or RAW photos straight out of the action camera and stitch it yourself to make a video.<br /><br />To stitch the photos to make video we can use simple yet very powerful ffmpeg command like utility.<br /><br />We may want to edit the photo in a tool like gimp before stitching to enhance them. probably in a batch as time-lapse involves a lot of photos.<br /><br />To create video out of the all the photo files in a directory, the following command can be used.<br /><br /><i>ffmpeg -r 5 -pattern_type glob -i '*.JPG'&nbsp; -s hd1080 -pix_fmt yuv420p -vcodec libx264 -crf 18 -preset slow timelapse.mp4</i><br /><br /><br />Note - I kept the frame rate to be only 5 tough usual frame rate of any video os 30fps or 60fps. In such fps our time-lapse will be extremely short , probably a second long and nothing really will be visible.<br /><br /><br />If the individual photos were tilted and not really straightened using gimp or any other photo editor then ffmpeg can be used for that. I found neither iMovie or any other free online tool could do rotation other than multiples of 90 degree.<br /><br /><i>ffmpeg -i timelapse.mp4 -vf “rotate=-6*PI/180” out.mp4</i><br /><br />Similarly, if the images were not cropped to only the area of interest , the whole video can be done afterwards using ffmpeg like as follows. I prefer not doing it at the photos level just in case they get misaligned. <br /><br /><br /><i>ffmpeg -i out.mp4 -filter:v "crop=in_w/2:in_h/1.7:in_w/20:in_h/5" -c:a copy out1.mp4</i><br /><br /><br />Finally we can trim the video and see the preview.<br /><br /><i>ffmpeg -ss 00:00:00.5 -i out1.mp4&nbsp; -c copy VideoClip.mp4</i><br /><br /><br /><i>ffplay VideoClip.mp4</i><br /><br /><br /><br /><br /><br /></div>