---
layout: post
title: Analysing Google Cloud Platform Billing Data
date: '2019-01-15T16:17:00.000+05:30'
author: Neil Ghosh
tags:
- Google Cloud Platform
- bigquery
- Billing
- GCP
modified_time: '2019-03-12T15:01:47.958+05:30'
thumbnail: https://1.bp.blogspot.com/-YRfIGtKjVFs/XEbyY_yja3I/AAAAAAACqFI/EuVpCrvv_dsi_3bMG-O0-e7W_4LiCjPGwCLcBGAs/s72-c/Screenshot%2B2019-01-22%2Bat%2B4.07.07%2BPM.png
blogger_id: tag:blogger.com,1999:blog-6081677503074893817.post-4378657647051437947
blogger_orig_url: https://www.neilghosh.com/2019/01/analysing-google-cloud-platform-billing.html
---

<div dir="ltr" style="text-align: left;" trbidi="on">No matter if you are a large enterprise or small startup, or even individual developers, you probably need to to know what you are paying for when it comes to cloud bill. in GCP you can <a href="https://cloud.google.com/billing/docs/how-to/export-data-bigquery">export your billing data to Google BigQuery</a> and then run queries on it to know where you are spending more which can help you control the cost you are incurring to run the infrastructure and app.<br /><br /><b>Daily spend</b><br /> <pre><br /> <code class="sql"><br />     SELECT<br /><br />      India_date,<br /><br />       ROUND(SUM(cost)) cost<br /><br />    FROM (<br /><br />      SELECT<br /><br />        DATE(DATETIME(usage_end_time,"Asia/Kolkata")) India_date,<br /><br />        cost<br /><br />      FROM<br /><br />        `YOUR_BILLING_EXPORT_TABLE`<br /><br />      WHERE<br /><br />        project.id = 'YOUR_PROJECT_ID'<br /><br />        AND _PARTITIONTIME &gt;= TIMESTAMP("2019-01-16")<br /><br />        AND _PARTITIONTIME &lt;= TIMESTAMP("2019-01-20") )<br /><br />    GROUP BY<br /><br />      India_date<br /><br />    Order by India_date<br /> </code><br /></pre> <b>Result</b><br /><div class="separator" style="clear: both; text-align: center;"><a href="https://1.bp.blogspot.com/-YRfIGtKjVFs/XEbyY_yja3I/AAAAAAACqFI/EuVpCrvv_dsi_3bMG-O0-e7W_4LiCjPGwCLcBGAs/s1600/Screenshot%2B2019-01-22%2Bat%2B4.07.07%2BPM.png" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="372" data-original-width="362" height="320" src="https://1.bp.blogspot.com/-YRfIGtKjVFs/XEbyY_yja3I/AAAAAAACqFI/EuVpCrvv_dsi_3bMG-O0-e7W_4LiCjPGwCLcBGAs/s320/Screenshot%2B2019-01-22%2Bat%2B4.07.07%2BPM.png" width="311" /></a></div><div class="separator" style="clear: both; text-align: center;">GCP Cost per day, taking timezone into account.</div><div class="separator" style="clear: both; text-align: center;"><br /></div><div class="separator" style="clear: both; text-align: center;"><br /></div><b>&nbsp;Cost By Services</b><br /><blockquote class="tr_bq">&nbsp; &nbsp; SELECT<br />&nbsp; &nbsp; &nbsp; item,<br />&nbsp; &nbsp; &nbsp; cost<br />&nbsp; &nbsp; FROM (<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; SELECT<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; service.description item,<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ROUND(SUM(cost)) cost<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; FROM<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; `YOUR_BILLING_EXPORT_TABLE`<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; WHERE<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;project.id = 'YOUR_PROJECT_ID'<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; AND _PARTITIONTIME &gt;= TIMESTAMP("2018-11-01")<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; AND _PARTITIONTIME &lt;= TIMESTAMP("2018-11-30")<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; GROUP BY<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; service.description )<br />&nbsp; &nbsp; ORDER BY<br />&nbsp; &nbsp; &nbsp; cost desc;</blockquote><b>Result</b><br /><br /><div class="separator" style="clear: both; text-align: center;"><a href="https://2.bp.blogspot.com/-0cJJduS2cRE/XEbzot7yqgI/AAAAAAACqFU/Sd4b8UWcLDUuG216cjpgYs36jHBxheieACLcBGAs/s1600/Screenshot%2B2019-01-22%2Bat%2B4.12.16%2BPM.png" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="536" data-original-width="556" height="308" src="https://2.bp.blogspot.com/-0cJJduS2cRE/XEbzot7yqgI/AAAAAAACqFU/Sd4b8UWcLDUuG216cjpgYs36jHBxheieACLcBGAs/s320/Screenshot%2B2019-01-22%2Bat%2B4.12.16%2BPM.png" width="320" /></a></div><div class="separator" style="clear: both; text-align: center;">Cost by GCP Service</div><div class="separator" style="clear: both; text-align: center;"><br /></div><div class="separator" style="clear: both; text-align: center;"><br /></div><div class="separator" style="clear: both; text-align: left;">Similarly, other queries can be executed for drilling further down within a service. i.e. the App Engine cost includes Cloud Datastore, networking, disks etc. One can find the breakdown with the following query.</div><div class="separator" style="clear: both; text-align: left;"><b><br /></b></div><div class="separator" style="clear: both; text-align: left;"><b>&nbsp;Cost by SKU for a specific service</b>&nbsp;</div><blockquote class="tr_bq" style="clear: both; text-align: left;">&nbsp;SELECT<br />&nbsp; &nbsp; &nbsp; item,<br />&nbsp; &nbsp; &nbsp; cost<br />&nbsp; &nbsp; FROM (<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; SELECT<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; sku.description item,<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ROUND(SUM(cost)) cost<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; FROM<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; `YOUR_BILING_EXPORT_TABLE`<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; WHERE<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;project.id = 'YOUR_PROJECT_ID'<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; AND _PARTITIONTIME &gt;= TIMESTAMP("2018-11-01")<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; AND _PARTITIONTIME &lt;= TIMESTAMP("2018-11-30")<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; AND&nbsp; service.description = 'App Engine'<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; GROUP BY<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; sku.description&nbsp; )<br />&nbsp; &nbsp; ORDER BY<br />&nbsp; &nbsp; &nbsp; cost desc;</blockquote><b>Result</b><br /><div class="separator" style="clear: both; text-align: center;"><a href="https://4.bp.blogspot.com/-o5494-PqAno/XEb0ncEcKII/AAAAAAACqFg/OZIqk-J8LpkcTpiqXyzmuY61xjS_gGi0ACLcBGAs/s1600/Screenshot%2B2019-01-22%2Bat%2B4.16.40%2BPM.png" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="544" data-original-width="570" height="305" src="https://4.bp.blogspot.com/-o5494-PqAno/XEb0ncEcKII/AAAAAAACqFg/OZIqk-J8LpkcTpiqXyzmuY61xjS_gGi0ACLcBGAs/s320/Screenshot%2B2019-01-22%2Bat%2B4.16.40%2BPM.png" width="320" /></a></div><br /><blockquote class="tr_bq"></blockquote></div>