---
layout: post
title: Online slate board using HTML5 websocket and glassfish
date: '2013-01-31T19:24:00.000+05:30'
author: Neil Ghosh
tags:
- collberative
- JavaEE7
- slate
- "#AdoptAJSR"
- whiteboard
- realtime
- Glassfish
- Websocket
- JUG
- HTML5
- java
modified_time: '2014-10-11T20:22:37.764+05:30'
blogger_id: tag:blogger.com,1999:blog-6081677503074893817.post-1372160283586410959
blogger_orig_url: https://www.neilghosh.com/2013/01/online-slate-board-using-html5.html
---

My<a title="Adopt-A-JSR at JUG Hyderabad" href="http://neilghosh.com/2013/01/30/adopt-a-jsr-at-jug-hyderabad/"> last post was about #AdoptAJSR</a> initiative in which JUG Hyderabad is actively involved. Meanwhile I was trying to explore the Websocket API for Java (JSR 356) using glassfish 4 's latest build as reference implementation.<br/><br/>The idea was to use <a href="http://www.html5rocks.com/en/tutorials/websockets/basics/">HTML5 websocket API</a> in the front end to communicate with websocket endpoint created in the glassfish server.  To get started with I referred a  similar sample application <a href="https://blogs.oracle.com/arungupta/entry/collaborative_whiteboard_using_websocket_in" target="_blank">blogged</a> by Arun Gupta.<br/><br/>In this process I managed to log following bugs against the reference implementation<br/><ol><br/>	<li><a href="http://java.net/jira/browse/TYRUS-73" target="_blank">Session object coming as the parameter in @WebSocketClose annotated method is null </a></li><br/>	<li><a href="http://java.net/jira/browse/TYRUS-76" target="_blank">Session#isOpen method returns NoSuchMethodException<br/></a><br/>To avoid this situation I have put the code "peer.getRemote().sendString("Ping");" in try block so that if it fails , it can gracefully remove that peer instead of ending up in exception.</li><br/></ol><br/>My app lets you draw freehand lines in the browser and the same gets drawn in real time at every other user's browser who is accessing this app. If you refresh the page or a new user joins in then the existing state of the drawing is shown the browser.<br/><br/>To create such project one has to go <a href="https://blogs.oracle.com/arungupta/entry/websockets_and_java_ee_7" target="_blank">maven way</a> as of now. Following are the major steps you need to care about while creating this project<br/><ol><br/>	<li>Choose a Maven project in Netbeans</li><br/></ol><br/><a href="http://neilghosh.com/blog/wp-content/uploads/2013/01/Maven1.png"><img class="alignright size-full wp-image-1454" alt="Maven1" src="http://neilghosh.com/blog/wp-content/uploads/2013/01/Maven1.png" width="624" height="441" /></a><br/><br/><a href="http://neilghosh.com/blog/wp-content/uploads/2013/01/Maven2.png"><img class="alignright size-full wp-image-1455" alt="Maven2" src="http://neilghosh.com/blog/wp-content/uploads/2013/01/Maven2.png" width="622" height="431" /></a><br/><br/><a href="http://neilghosh.com/blog/wp-content/uploads/2013/01/Maven3.png"><img class="alignright size-full wp-image-1456" alt="Maven3" src="http://neilghosh.com/blog/wp-content/uploads/2013/01/Maven3.png" width="629" height="449" /></a><br/><br/>2. The Websocket Java APIs could not be imported in the Java class unless the websocket library is searched in the repository and added to the project<br/><br/><a href="http://neilghosh.com/blog/wp-content/uploads/2013/01/maven4.png"><img class="alignright size-full wp-image-1457" alt="maven4" src="http://neilghosh.com/blog/wp-content/uploads/2013/01/maven4.png" width="624" height="364" /></a><br/><br/><a href="http://neilghosh.com/blog/wp-content/uploads/2013/01/maven5.png"><img class="size-full wp-image-1453 alignnone" alt="maven5" src="http://neilghosh.com/blog/wp-content/uploads/2013/01/maven5.png" width="464" height="402" /></a><br/><br/>The source code that I created can be accessed from <a href="https://github.com/neilghosh/slate" target="_blank">Github</a>. Feel free to download and give feedback or try to create your own version.<br/><br/>You can download the<a href="http://neilghosh.com/blog/wp-content/uploads/2013/01/Slate_Demo.swf"> slate demo</a> video and play in any flash enabled browser.<br/><br/><!-- copy and paste. Modify height and width if desired. -->Play this in full screen to see the code.<br/><object id="scPlayer" width="617" height="372" classid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000" codebase="http://download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=6,0,40,0"><param name="quality" value="high" /><param name="flashVars" value="thumb=http://content.screencast.com/users/NeilGhosh/folders/Jing/media/5054fd99-ffe0-4760-a0ec-717b5022b99b/FirstFrame.jpg&amp;containerwidth=1672&amp;containerheight=1005&amp;content=http://content.screencast.com/users/NeilGhosh/folders/Jing/media/5054fd99-ffe0-4760-a0ec-717b5022b99b/Slate%20Demo.swf&amp;blurover=false" /><param name="allowFullScreen" value="true" /><param name="scale" value="showall" /><param name="allowScriptAccess" value="always" /><param name="base" value="http://content.screencast.com/users/NeilGhosh/folders/Jing/media/5054fd99-ffe0-4760-a0ec-717b5022b99b/" /><param name="src" value="http://content.screencast.com/users/NeilGhosh/folders/Jing/media/5054fd99-ffe0-4760-a0ec-717b5022b99b/jingswfplayer.swf" /><param name="flashvars" value="thumb=http://content.screencast.com/users/NeilGhosh/folders/Jing/media/5054fd99-ffe0-4760-a0ec-717b5022b99b/FirstFrame.jpg&amp;containerwidth=1672&amp;containerheight=1005&amp;content=http://content.screencast.com/users/NeilGhosh/folders/Jing/media/5054fd99-ffe0-4760-a0ec-717b5022b99b/Slate%20Demo.swf&amp;blurover=false" /><param name="allowfullscreen" value="true" /><param name="allowscriptaccess" value="always" /><embed id="scPlayer" width="617" height="372" type="application/x-shockwave-flash" src="http://content.screencast.com/users/NeilGhosh/folders/Jing/media/5054fd99-ffe0-4760-a0ec-717b5022b99b/jingswfplayer.swf" quality="high" flashVars="thumb=http://content.screencast.com/users/NeilGhosh/folders/Jing/media/5054fd99-ffe0-4760-a0ec-717b5022b99b/FirstFrame.jpg&amp;containerwidth=1672&amp;containerheight=1005&amp;content=http://content.screencast.com/users/NeilGhosh/folders/Jing/media/5054fd99-ffe0-4760-a0ec-717b5022b99b/Slate%20Demo.swf&amp;blurover=false" allowFullScreen="true" scale="showall" allowScriptAccess="always" base="http://content.screencast.com/users/NeilGhosh/folders/Jing/media/5054fd99-ffe0-4760-a0ec-717b5022b99b/" flashvars="thumb=http://content.screencast.com/users/NeilGhosh/folders/Jing/media/5054fd99-ffe0-4760-a0ec-717b5022b99b/FirstFrame.jpg&amp;containerwidth=1672&amp;containerheight=1005&amp;content=http://content.screencast.com/users/NeilGhosh/folders/Jing/media/5054fd99-ffe0-4760-a0ec-717b5022b99b/Slate%20Demo.swf&amp;blurover=false" allowfullscreen="true" allowscriptaccess="always" />Unable to display content. Adobe Flash is required.</object><br/><br/>Further features and future challenges<br/><ol><br/>	<li>Draw the existing lines slowly (Playback) when a new user joins in so that he gets the context. For this, one needs to block other users ( <a href="http://ejohn.org/blog/how-javascript-timers-work/" target="_blank">javaScript thread</a> ) from drawing till the playback is over. or some way to buffer the new drawings till the JavaScript thread is free from playback.</li><br/>	<li>Different color and strokes</li><br/>	<li>Simultaneous drawing using <a href="http://www.w3schools.com/html/html5_webworkers.asp" target="_blank">webworkers</a>.</li><br/></ol>